<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>üéÆ –Ü–≥—Ä–∏</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: system-ui, sans-serif;
            padding: 20px;
            background: #1a1a2e;
            color: white;
            text-align: center;
        }
        button {
            background: #0f3460;
            color: white;
            border: none;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 10px;
            font-size: 18px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>üéÆ –Ü–ì–†–û–í–ò–ô –¶–ï–ù–¢–†</h1>
    <p id="status">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>
    <p id="user"></p>
    <p id="balance"></p>
    
    <button onclick="joinMafia()">üî™ –ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –¥–æ –º–∞—Ñ—ñ—ó</button>
    <button onclick="playSlots(10)">üé∞ –°–ª–æ—Ç–∏ 10 ü™ô</button>
    <button onclick="playSlots(50)">üé∞ –°–ª–æ—Ç–∏ 50 ü™ô</button>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();
        
        // –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('user_id');
        const username = urlParams.get('username') || '–ì—Ä–∞–≤–µ—Ü—å';
        const balance = urlParams.get('balance') || '1000';
        
        document.getElementById('user').innerHTML = `üë§ @${username}`;
        document.getElementById('balance').innerHTML = `üí∞ ${balance} ü™ô`;
        document.getElementById('status').innerHTML = '‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ –¥–æ –±–æ—Ç–∞!';
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º init –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        tg.sendData(JSON.stringify({
            action: 'init',
            user_id: userId,
            username: username
        }));
        
        function joinMafia() {
            tg.sendData(JSON.stringify({
                action: 'mafia_join',
                user_id: userId,
                username: username
            }));
            tg.showAlert('–ó–∞–ø–∏—Ç –Ω–∞ –ø—Ä–∏—î–¥–Ω–∞–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ!');
        }
        
        function playSlots(bet) {
            tg.sendData(JSON.stringify({
                action: 'slots_spin',
                user_id: userId,
                bet: bet
            }));
        }
        
        // –°–ª—É—à–∞–µ–º –æ—Ç–≤–µ—Ç—ã –æ—Ç –±–æ—Ç–∞
        tg.onEvent('webAppData', function(data) {
            try {
                const response = JSON.parse(data);
                console.log('Response:', response);
                
                if (response.balance) {
                    document.getElementById('balance').innerHTML = `üí∞ ${response.balance} ü™ô`;
                }
            } catch (e) {}
        });
    </script>
</body>
</html>
